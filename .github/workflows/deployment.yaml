name: deploy react App
on:
  push:
    branches:
      - main
    #paths-ignore:
    # - '.github/workflows/*' на игнор
jobs:
   test:
    runs-on: ubuntu-latest
    steps: 
    - name: get repository code
      uses: actions/checkout@v3
    - name: install cache
      uses: actions/cache@v3
      with: 
          path: ~/.npm
          key: node-modules-${{ hashFiles('**/package-lock.json') }} # либо поставить просто статический node-modules-devops 
    - name: install dependecies
      run: npm ci # can install into ci
    - name: Test aplication
      run: npm run test
   lint:
      runs-on: ubuntu-latest
      needs: test
      steps: 
      - name: get repository code
        uses: actions/checkout@v3
      - name: install cache
        uses: actions/cache@v3
        with: 
          path: ~/.npm
          key: node-modules-${{ hashFiles('**/package-lock.json') }} # либо поставить просто статический node-modules-devops 

      - name: install dependecies
        run: npm ci # can install into ci
      - name: lint aplication
        run: npm run lint
   build:
      runs-on: ubuntu-latest
      needs: lint
      steps: 
      - name: get repository code
        uses: actions/checkout@v3
      - name: install cache
        uses: actions/cache@v3
        with: 
          path: ~/.npm
          key: node-modules-${{ hashFiles('**/package-lock.json') }} # либо поставить просто статический node-modules-devops 
      - name: install dependecies
        run: npm ci # can install into ci
      - name: build aplication
        run: npm run build
      - name: deploy
        run: echo deploying...




  